<view class="logistics-page">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç‰©æµä¿¡æ¯ -->
  <scroll-view class="content" scroll-y wx:if="{{!loading && order}}">
    <!-- è®¢å•ä¿¡æ¯ -->
    <view class="order-section">
      <view class="section-title">è®¢å•ä¿¡æ¯</view>
      <view class="order-card">
        <view class="order-row">
          <text class="order-label">è®¢å•å·</text>
          <text class="order-value">{{order.orderNo}}</text>
        </view>
        <view class="order-row" wx:if="{{order.receiverName}}">
          <text class="order-label">æ”¶è´§äºº</text>
          <text class="order-value">{{order.receiverName}} {{order.receiverPhone}}</text>
        </view>
        <view class="order-row" wx:if="{{order.shippingAddress}}">
          <text class="order-label">æ”¶è´§åœ°å€</text>
          <text class="order-value">{{order.shippingAddress}}</text>
        </view>
      </view>
    </view>

    <!-- ç‰©æµçŠ¶æ€ -->
    <view class="status-section">
      <view class="status-card">
        <view class="status-icon" style="color: {{getLogisticsStatus().color}}">
          <text>{{getLogisticsStatus().icon}}</text>
        </view>
        <text class="status-text">{{getLogisticsStatus().text}}</text>
      </view>
    </view>

    <!-- ç‰©æµä¿¡æ¯ -->
    <view class="logistics-section" wx:if="{{logistics.trackingNumber || logistics.shippingCompany}}">
      <view class="section-title">ç‰©æµä¿¡æ¯</view>
      <view class="logistics-card">
        <view class="logistics-row" wx:if="{{logistics.shippingCompany}}">
          <text class="logistics-label">ç‰©æµå…¬å¸</text>
          <text class="logistics-value">{{logistics.shippingCompany}}</text>
        </view>
        <view class="logistics-row" wx:if="{{logistics.trackingNumber}}">
          <text class="logistics-label">ç‰©æµå•å·</text>
          <view class="logistics-value-wrapper">
            <text class="logistics-value">{{logistics.trackingNumber}}</text>
            <text class="copy-btn" bindtap="onCopyTrackingNumber">å¤åˆ¶</text>
          </view>
        </view>
        <view class="logistics-row" wx:if="{{logistics.shippingMethod}}">
          <text class="logistics-label">é…é€æ–¹å¼</text>
          <text class="logistics-value">{{logistics.shippingMethod}}</text>
        </view>
        <view class="logistics-row" wx:if="{{logistics.shippedAt}}">
          <text class="logistics-label">å‘è´§æ—¶é—´</text>
          <text class="logistics-value">{{formatTime(logistics.shippedAt)}}</text>
        </view>
        <view class="logistics-row" wx:if="{{logistics.deliveredAt}}">
          <text class="logistics-label">é€è¾¾æ—¶é—´</text>
          <text class="logistics-value">{{formatTime(logistics.deliveredAt)}}</text>
        </view>
      </view>
    </view>

    <!-- ç‰©æµè½¨è¿¹ -->
    <view class="tracking-section" wx:if="{{trackingInfo && trackingInfo.traces && trackingInfo.traces.length > 0}}">
      <view class="section-title">ç‰©æµè½¨è¿¹</view>
      <view class="tracking-card">
        <view 
          class="tracking-item {{index === 0 ? 'active' : ''}}"
          wx:for="{{trackingInfo.traces}}"
          wx:key="index"
          wx:for-index="index"
        >
          <view class="tracking-dot"></view>
          <view class="tracking-line" wx:if="{{index < trackingInfo.traces.length - 1}}"></view>
          <view class="tracking-content">
            <text class="tracking-desc">{{item.desc}}</text>
            <text class="tracking-location" wx:if="{{item.location}}">{{item.location}}</text>
            <text class="tracking-time">{{formatTime(item.time)}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æš‚æ— ç‰©æµä¿¡æ¯ -->
    <view class="empty-section" wx:if="{{!logistics.trackingNumber && !logistics.shippingCompany}}">
      <text class="empty-icon">ğŸ“¦</text>
      <text class="empty-text">æš‚æ— ç‰©æµä¿¡æ¯</text>
      <text class="empty-desc">è®¢å•å°šæœªå‘è´§ï¼Œè¯·è€å¿ƒç­‰å¾…</text>
    </view>
  </scroll-view>
</view>

